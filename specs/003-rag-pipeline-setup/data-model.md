# Data Model: RAG Pipeline Setup & Embedding Storage

This document outlines the data structures and their relationships for the RAG pipeline's embedding and storage phase.

## 1. Text Chunk

Represents a segment of text extracted from the textbook.

-   **`id`**: A unique identifier for the chunk (e.g., UUID generated during ingestion).
-   **`content`**: The actual text string of the chunk.
-   **`metadata`**: A dictionary containing contextual information about the chunk.
    -   **`source_url`**: (string) The URL of the Docusaurus page from which the chunk was extracted.
    -   **`chapter_title`**: (string) The title of the chapter the chunk belongs to.
    -   **`module_name`**: (string) The name of the module the chapter belongs to.
    -   **`document_id`**: (string, optional) A unique ID for the original document (e.g., entire chapter or book section).
    -   **`chunk_number`**: (integer, optional) The sequential number of the chunk within its document.
    -   **`start_offset`**: (integer, optional) The starting character offset of the chunk within the original document.

## 2. Embedding

A vector representation of a `Text Chunk` generated by Cohere `embed-english-v3.0`.

-   **`vector`**: A list of floating-point numbers representing the embedding.
-   **`dimensions`**: (integer) The dimensionality of the vector (e.g., 1024 for Cohere `embed-english-v3.0`).

## 3. Qdrant Collection (Vector Database)

The primary storage for embeddings and their associated metadata.

-   **`collection_name`**: (string) The name of the Qdrant collection (e.g., `textbook_embeddings`).
-   **`vector_size`**: (integer) The dimensionality of the vectors stored in the collection (e.g., 1024).
-   **`distance_metric`**: (string) The metric used for calculating vector similarity (e.g., `Cosine`).
-   **`payload_schema`**: The schema defining the metadata fields for each stored point.
    -   `source_url`: (keyword, indexed) Enables filtering by source.
    -   `chapter_title`: (keyword, indexed) Enables filtering by chapter.
    -   `module_name`: (keyword, indexed) Enables filtering by module.
    -   `document_id`: (keyword, indexed) Enables filtering by original document.
    -   `chunk_number`: (integer, indexed) Enables filtering/sorting by chunk order.
    -   `content`: (text, indexed) The original text of the chunk, for retrieval and display.

### Relationships

-   Each `Text Chunk` is associated with one `Embedding`.
-   Each `Embedding` is stored as a point in the `Qdrant Collection`, along with its `Text Chunk` content and `metadata` as payload.
