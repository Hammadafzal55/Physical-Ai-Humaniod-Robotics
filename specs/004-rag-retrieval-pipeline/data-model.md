# Data Model: Retrieval Pipeline (Vector Search & Context Assembly)

This document outlines the key entities and their structures relevant to the RAG retrieval pipeline. It reuses existing definitions from Spec 3 where applicable.

## 1. User Query

Represents the natural language text input from the user.

*   **`query_text`** (String): The user's question or prompt.

## 2. Query Embedding

Represents the vector-space numerical representation of the User Query.

*   **`vector`** (Array of Floats): The dense vector representation generated by Cohere `embed-english-v3.0`. Its dimensionality must match the document embeddings in Qdrant.

## 3. Retrieved Chunk

Represents a chunk of text retrieved from Qdrant, along with its associated metadata and relevance score. This entity maps directly to the structure returned by Qdrant and prepared for agent consumption.

*   **`id`** (String, UUID): Unique identifier of the text chunk (inherited from TextChunk in Spec 3).
*   **`content`** (String): The textual content of the chunk.
*   **`metadata`** (Object): Contains additional contextual information about the chunk.
    *   **`source_url`** (String, URL): URL of the source document (from Spec 3 metadata).
    *   **`chapter_title`** (String, Optional): Title of the chapter (from Spec 3 metadata).
    *   **`module_name`** (String, Optional): Name of the module (from Spec 3 metadata).
    *   **`timestamp`** (String, ISO 8601, Optional): Timestamp of extraction (from Spec 3 metadata).
*   **`relevance_score`** (Float): The similarity score from Qdrant, indicating how relevant this chunk is to the query.

## 4. Relationship to Existing Data Model (from Spec 3)

The `Retrieved Chunk` entity directly corresponds to the `TextChunk` structure stored in Qdrant (from Spec 3's `data-model.md`), augmented with a `relevance_score` from the Qdrant search result. The `TextChunkMetadata` structure remains consistent.
